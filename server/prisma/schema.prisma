generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = "mongodb://localhost:27017/auction?authSource=admin"
}

model Users {
  id        String        @id @default(auto()) @map("_id") @db.ObjectId
  cid       String        @unique @default(uuid()) @db.String
  phone     String        @unique @default(uuid()) @db.String
  email     String        @unique @db.String
  fullname  String        @db.String
  password  String        @db.String
  role      UserRole      @default(USER)
  avatar    String?       @db.String
  address   String        @default("") @db.String
  gender    UserGender    @default(OTHER)
  banned    Boolean       @default(false) @db.Bool
  ban_until DateTime      @default(now()) @db.Timestamp
  setting   UserSettings?
  created   Plates[]
  History   History[]
}

model UserSettings {
  id                    String  @id @default(auto()) @map("_id") @db.ObjectId
  user                  Users   @relation(fields: [uid], references: [id])
  uid                   String  @unique @db.ObjectId
  displayAttendedPlate  Boolean @default(false) @db.Bool
  displayCollectedPlate Boolean @default(false) @db.Bool
}

model Plates {
  id       String       @id @default(auto()) @map("_id") @db.ObjectId
  plate    String       @unique @db.String
  province String       @db.String
  type     PlateType    @default(PHONGTHUY)
  vehicle  PlateVehicle @default(CAR)
  user     Users        @relation(fields: [uid], references: [id])
  uid      String       @db.ObjectId
  Room     Room?
}

model Sessions {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  device   String @db.String
  language String @db.String
  timezone String @db.String
  platform String @db.String
  ip       String @db.String
}

model Room {
  id      String    @id @default(auto()) @map("_id") @db.ObjectId
  plate   Plates    @relation(fields: [pid], references: [id])
  pid     String    @unique @db.ObjectId
  History History[]
}

model History {
  id    String   @id @default(auto()) @map("_id") @db.ObjectId
  user  Users    @relation(fields: [uid], references: [id])
  room  Room     @relation(fields: [rid], references: [id])
  uid   String   @db.ObjectId
  rid   String   @db.ObjectId
  value String
  time  DateTime @db.Timestamp
}

enum UserRole {
  ADMIN
  PROVIDER
  USER
  AUCTIONEER
}

enum UserGender {
  MALE
  FEMALE
  OTHER
}

enum PlateType {
  NGUQUY
  TUQUY
  TAMHOA
  LOCPHAT
  ONGDIA
  SANHTIEN
  PHONGTHUY
}

enum PlateVehicle {
  CAR
  LONG_CAR
}
